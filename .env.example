# ==============================================
# RAYA BACKEND — Configuration Reference (.env.example)
# ==============================================
# Copier ce fichier en .env et configurer les valeurs
#
#   cp .env.example .env
#
# Variables marquées (REQUIRED) : obligatoires, le serveur refusera de démarrer sans elles.
# Variables marquées (OPTIONAL) : ont des valeurs par défaut, non requises en dev.
#
# La validation est effectuée au démarrage par src/config/env.validation.ts
# ==============================================

# ==================== Application ====================
# (REQUIRED) Environment: development | production | test | staging
NODE_ENV=development

# (OPTIONAL) Port d'écoute HTTP — défaut: 3000
PORT=3000

# (OPTIONAL) Niveau de log: debug | info | warn | error — défaut: debug
LOG_LEVEL=debug

# (OPTIONAL) Nom de l'application affiché dans les emails — défaut: Raya
APP_NAME=Raya

# ==================== Database ====================
# (OPTIONAL) Type de base de données: better-sqlite3 | postgres — défaut: better-sqlite3
# Auto-détecté si DATABASE_URL est définie (postgres:// → postgres)
DB_TYPE=better-sqlite3

# (OPTIONAL) Nom de la base / chemin du fichier SQLite — défaut: raya_dev.sqlite
DB_DATABASE=raya_dev.sqlite

# (OPTIONAL) URL complète de connexion — Railway/cloud l'injectent automatiquement
# Si définie, DB_TYPE est auto-détecté en 'postgres' et les champs individuels sont ignorés
# DATABASE_URL=postgresql://user:password@host:port/database

# -- Les champs suivants sont requis si DB_TYPE=postgres ET DATABASE_URL n'est pas définie --
# DB_HOST=localhost
# DB_PORT=5432
# DB_USERNAME=raya
# DB_PASSWORD=your_secure_password
# DB_SSL=false

# (OPTIONAL) Synchronize automatiquement le schéma avec les entités
# ⚠️  DANGER: TOUJOURS 'false' en production! Utilisez les migrations.
# Mettre 'true' uniquement pour le développement initial
DB_SYNCHRONIZE=false

# (OPTIONAL) Exécuter les migrations au démarrage
# Mettre 'true' pour exécuter les migrations automatiquement
DB_MIGRATIONS_RUN=true

# ==================== JWT ====================
# (REQUIRED) Secret pour signer les access tokens — minimum 16 caractères !
# ⚠️  CHANGER IMPÉRATIVEMENT en production
JWT_SECRET=change-this-to-a-very-long-and-secure-secret-key-in-production

# (REQUIRED) Secret pour signer les refresh tokens — minimum 16 caractères !
JWT_REFRESH_SECRET=change-this-to-another-very-long-secret-key

# (OPTIONAL) Durée de vie access token en secondes — défaut: 3600 (1h)
JWT_EXPIRES_IN=3600

# (OPTIONAL) Durée de vie refresh token en secondes — défaut: 604800 (7j)
JWT_REFRESH_EXPIRES_IN=604800

# ==================== CORS ====================
# (OPTIONAL) URL du frontend — défaut: http://localhost:4200
FRONTEND_URL=http://localhost:4200

# (OPTIONAL) Origines autorisées, séparées par virgule
ALLOWED_ORIGINS=http://localhost:8080,http://localhost:5500,http://localhost:3001,http://localhost:5173

# (OPTIONAL) URLs production/staging pour CORS strict
PRODUCTION_URL=https://app.rayamanager.com
PRODUCTION_ADMIN_URL=https://admin.rayamanager.com
# STAGING_URL=https://staging.rayamanager.com

# ==================== Redis / Cache ====================
# (OPTIONAL en dev) Redis pour cache distribué et OTP
# ⚠️  REQUIS en production/cluster pour :
#   - Stockage OTP (codes de vérification)
#   - Cache partagé entre instances
#   - Sessions distribuées (si activé)
#
# Railway injecte automatiquement REDIS_URL si un service Redis est ajouté
# REDIS_URL=redis://:password@host:port

# Alternative: configuration individuelle
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=
# REDIS_DB=0

# (OPTIONAL) TTL du cache en secondes — défaut: 300 (5min)
CACHE_TTL=300

# ==================== Rate Limiting ====================
# (OPTIONAL) Fenêtre de rate limiting en secondes — défaut: 60
RATE_LIMIT_TTL=60

# (OPTIONAL) Nombre max de requêtes par fenêtre — défaut: 100
RATE_LIMIT_MAX=100

# ==================== Email / SMTP ====================
# (OPTIONAL) Configuration SMTP — requis pour envoyer des emails (reset password, OTP, etc.)
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your-email@gmail.com
# SMTP_PASS=your-app-password
# SMTP_FROM="Raya" <noreply@raya.app>

# ==================== OAuth ====================
# (OPTIONAL) Google OAuth — requis pour la connexion Google
# GOOGLE_CLIENT_ID=your-google-client-id
# GOOGLE_CLIENT_SECRET=your-google-client-secret
# GOOGLE_CALLBACK_URL=http://localhost:3000/api/auth/google/callback

# (OPTIONAL) GitHub OAuth — requis pour la connexion GitHub
# GITHUB_CLIENT_ID=your-github-client-id
# GITHUB_CLIENT_SECRET=your-github-client-secret
# GITHUB_CALLBACK_URL=http://localhost:3000/api/auth/github/callback

# ==================== 2FA ====================
# (OPTIONAL) Nom affiché dans l'app d'authentification — défaut: RayaBoutique
TWO_FACTOR_APP_NAME=RayaBoutique

# ==================== Fichiers ====================
# (OPTIONAL) Répertoire d'upload — défaut: ./uploads
UPLOAD_DIR=./uploads

# (OPTIONAL) Taille max fichier en octets — défaut: 10485760 (10 MB)
MAX_FILE_SIZE=10485760

# ==================== Backups automatiques ====================
# (OPTIONAL) Répertoire de backups — défaut: ./backups
BACKUP_DIR=./backups

# (OPTIONAL) Activer les backups automatiques (daily/weekly/monthly) — défaut: true
BACKUP_AUTO_ENABLED=true

# (OPTIONAL) Rétention des backups en jours — défaut: 30
BACKUP_RETENTION_DAYS=30

# (OPTIONAL) Nombre maximum de backups à conserver — défaut: 50
BACKUP_MAX_COUNT=50

# (OPTIONAL) Compresser les backups (gzip) — défaut: true
BACKUP_COMPRESS=true

# ==================== Cloud Storage (S3/R2/MinIO) ====================
# (OPTIONAL) Configuration S3 pour stockage offsite des backups
# Supporte AWS S3, Cloudflare R2, MinIO, DigitalOcean Spaces, etc.
# S3_BUCKET=raya-backups
# S3_ENDPOINT=https://s3.amazonaws.com
# S3_REGION=us-east-1
# S3_ACCESS_KEY_ID=your-access-key
# S3_SECRET_ACCESS_KEY=your-secret-key
# S3_FORCE_PATH_STYLE=false

# ==================== Multi-Tenant ====================
# (OPTIONAL) Tenant par défaut pour les nouveaux utilisateurs OAuth — défaut: default
DEFAULT_TENANT_ID=default

# ==================== Domaines Personnalisés ====================
# (OPTIONAL) Domaine principal de la plateforme — défaut: raya.app
PLATFORM_DOMAIN=raya.app

# (OPTIONAL) IP du serveur pour A record — utilisé pour les instructions DNS
# SERVER_IP=123.45.67.89

# (OPTIONAL) Cible CNAME pour les domaines personnalisés — défaut: proxy.raya.app
# CNAME_TARGET=proxy.raya.app

# ==================== Code d'Activation App ====================
# (REQUIRED) Code unique pour activer l'application lors du premier téléchargement
# Ce code est donné aux utilisateurs pour débloquer l'accès à l'app
APP_ACTIVATION_CODE=RAYA2026

# ==================== Monitoring & Logs ====================
# (OPTIONAL) DSN Sentry pour l'envoi des erreurs — laissez vide pour désactiver
# SENTRY_DSN=https://your-key@sentry.io/project-id

# (OPTIONAL) Format JSON pour les logs — utile en production avec ELK/Datadog — défaut: false
LOG_JSON=false

# (OPTIONAL) Rétention des données de monitoring en jours — défaut: 30
MONITORING_RETENTION_DAYS=30

# (OPTIONAL) Webhooks pour les alertes — format: URL
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
# DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR/WEBHOOK
# ALERT_WEBHOOK_URL=https://your-alerting-service.com/webhook